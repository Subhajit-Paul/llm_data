<!DOCTYPE html>
<html>
<head>
    <title>‡¶ö‡¶∞‡¶Æ‡¶™‡¶®‡ßç‡¶•‡ßÄ ‡¶á‡¶û‡ßç‡¶ú‡¶ø‡¶®‡¶ø‡¶Ø‡¶º‡¶æ‡¶∞ üî¥</title>
    {% load static %}
    <link rel="icon" type="image/jpg" href="{% static 'img/logo.jpg' %}">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            background-image: url("{% static 'img/OIG_.jpg' %}");
            font-family: 'Montserrat', sans-serif;
            color: #fff;
            background-size:cover;
        }

        .form-group {
    display: flex;
    align-items: center;
}

.form-group button {
    margin-left: 10px;
}
        .container {
            max-width: 600px;
            padding-top: 25px;
            padding-bottom: 35px;
            margin: 90px auto;
            padding-left: 60px;
            padding-right: 60px;
            background-color: rgba(255, 255, 255, .05);
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            border-radius: 50px;
        }
        
        h1 {
            color: #fff;
            font-weight: 700;
            margin-bottom: 30px;
        }
        
        form {
            margin-top: 30px;
        }
        
        label {
            color: #fff;
            font-weight: 700;
            padding-left: 15px;
            font-size: 14px;
        }
        
        input[type="text"] {
            width: 100%;
            padding: 10px;
            background-color: #ffffff;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            color: #585858;
            margin-bottom: 10px;
        }
        
        button[type="submit"] {
            display: block;
            width: 100%;
            padding: 10px;
            background-color: #4c74af;
            color: #fff;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
        }
        
        button[type="submit"]:hover {
            background-color: #4563a0;
        }

        .another-blah {
            text-align: center;
        }
        .rounded-image {
            border-radius: 50%;
            padding: 5px;
        }
        .rainbow-slider {
            background: linear-gradient(to right, #ff00cc, #00ffcc);
            box-shadow: 0 0 10px #379bff;
            border-radius: 50%;
        }
        @keyframes pulse {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.1);
            }
            100% {
                transform: scale(1);
            }
        }

        .listening {
            animation: pulse 1s infinite;
        }

    </style>
</head>
<body>
    <div class="container">
        <div class="another-blah">
            <img class="rounded-image" src="{% static 'img/logo.jpg' %}" height="100px" width="100px" alt="Rounded Image">
            <h1>Okay, Let's Start üòÄ</h1>
        </div>
        <form action="{% url 'submit_form' %}" method="post">
            {% csrf_token %}
            <label for="context">‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶™‡ßç‡¶∞‡¶∏‡¶ô‡ßç‡¶ó ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ñ‡ßç‡¶Ø‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®</label>
            <div class="form-group">
                <input type="text" id="contextInp" name="context" placeholder="‡¶ó‡ßÄ‡¶§‡¶æ‡¶û‡ßç‡¶ú‡¶≤‡¶ø, ‡¶ï‡¶¨‡¶ø ‡¶∞‡¶¨‡ßÄ‡¶®‡ßç‡¶¶‡ßç‡¶∞‡¶®‡¶æ‡¶• ‡¶†‡¶æ‡¶ï‡ßÅ‡¶∞‡ßá‡¶∞ ‡¶è‡¶ï‡¶ü‡¶ø ‡¶ï‡¶¨‡¶ø‡¶§‡¶æ‡¶∞ ‡¶∏‡¶Ç‡¶ï‡¶≤‡¶®" data-toggle="tooltip" title="‡¶è‡¶ï‡¶ü‡¶ø ‡¶¨‡¶ø‡¶∑‡¶Ø‡¶º‡ßá‡¶∞ ‡¶¨‡¶ø‡¶≠‡¶ø‡¶®‡ßç‡¶® ‡¶™‡ßç‡¶∞‡¶∏‡¶ô‡ßç‡¶ó ‡¶π‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá, ‡¶∏‡ßá‡¶á ‡¶™‡ßç‡¶∞‡¶∏‡¶ô‡ßç‡¶ó‡ßá‡¶∞ ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø‡¶§‡ßá ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶è‡¶¨‡¶Ç ‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶∏‡¶Ç‡¶ï‡¶≤‡¶ø‡¶§ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡•§ ‡¶Ø‡ßá‡¶Æ‡¶®, ‡¶™‡ßç‡¶∞‡¶∏‡¶ô‡ßç‡¶ó ‡¶π‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá - ‡ßß‡ßØ‡ß™‡ß≠ ‡¶∏‡¶æ‡¶≤‡ßá‡¶∞ ‡ßß‡ß´ ‡¶á ‡¶Ü‡¶ó‡¶∏‡ßç‡¶ü ‡¶≠‡¶æ‡¶∞‡¶§ ‡¶∏‡ßç‡¶¨‡¶æ‡¶ß‡ßÄ‡¶®‡¶§‡¶æ ‡¶≤‡¶æ‡¶≠ ‡¶ï‡¶∞‡ßá‡•§
‡¶è‡¶á ‡¶™‡ßç‡¶∞‡¶∏‡¶ô‡ßç‡¶ó ‡¶∏‡¶Æ‡ßç‡¶¨‡¶®‡ßç‡¶ß‡¶ø‡¶§ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶π‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá - ‡¶≠‡¶æ‡¶∞‡¶§ ‡¶ï‡¶§ ‡¶∏‡¶æ‡¶≤‡ßá ‡¶∏‡ßç‡¶¨‡¶æ‡¶ß‡ßÄ‡¶®‡¶§‡¶æ ‡¶≤‡¶æ‡¶≠ ‡¶ï‡¶∞‡ßá?
‡¶è‡¶á ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®‡ßá‡¶∞ ‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶è‡¶á ‡¶™‡ßç‡¶∞‡¶∏‡¶ô‡ßç‡¶ó‡ßá ‡¶π‡¶¨‡ßá - ‡ßß‡ßØ‡ß™‡ß≠ ‡¶∏‡¶æ‡¶≤‡ßá‡¶∞ ‡ßß‡ß´‡¶á ‡¶Ü‡¶ó‡¶∏‡ßç‡¶ü"  required>
<button type="button" class="btn mb-3" id="voiceContextBtn" onclick="handleClick(event);"><img src="https://www.iconfinder.com/icons/7123011/download/png/512" height="40" width="40"></button>
            </div>
            <div class="form-group">
                <label for="number">‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ :</label>
                <input type="range" id="number" class="rainbow-slider" data-toggle="tooltip" title="‡¶è‡¶ï‡¶ü‡¶ø ‡¶™‡ßç‡¶∞‡¶∏‡¶ô‡ßç‡¶ó ‡¶∏‡¶Æ‡ßç‡¶¨‡¶®‡ßç‡¶ß‡¶ø‡¶§ ‡¶è‡¶ï‡¶æ‡¶ß‡¶ø‡¶ï ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶∏‡¶Ç‡¶ï‡¶≤‡¶ø‡¶§ ‡¶ï‡¶∞‡¶æ ‡¶Ø‡ßá‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá, ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ ‡ßß ‡¶•‡ßá‡¶ï‡ßá ‡ßÆ ‡¶è‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®‡•§" name="number" min="1" max="8" value="1" onchange="generateFields(this.value)" required>
                <span id="numberDisplay">1</span>
            </div>
            <div id="fieldsContainer" class="dynamic-fields"></div>
            <button type="submit" class="btn btn-primary">Submit</button>
        </form>
    </div>
    <script>
        generateFields(1);
        function generateFields(value) {
  var fieldsContainer = document.getElementById("fieldsContainer");
  fieldsContainer.innerHTML = "";

  for (var i = 0; i < value; i++) {
    var questionContainer = document.createElement("div");
    questionContainer.className = "question-container";

    var questionRow = document.createElement("div");
    questionRow.className = "row";

    var questionInputCol = document.createElement("div");
    questionInputCol.className = "col";

    var questionLabel = document.createElement("label");
    questionLabel.textContent = "‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®‡¶ü‡¶ø ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®";

    var questionInput = document.createElement("input");
    questionInput.type = "text";
    questionInput.name = "question" + (i + 1);
    questionInput.id = "question" + (i + 1);
    questionInput.placeholder = "‡¶ó‡ßÄ‡¶§‡¶æ‡¶û‡ßç‡¶ú‡¶≤‡¶ø ‡¶ï‡ßá ‡¶≤‡¶ø‡¶ñ‡ßá‡¶õ‡ßá‡¶®?";
    questionInput.className = "dynamic-input-question";
    questionInput.title = "‡¶â‡¶™‡¶∞‡ßá ‡¶≤‡¶ø‡¶ñ‡¶ø‡¶§ ‡¶™‡ßç‡¶∞‡¶∏‡¶ô‡ßç‡¶ó‡¶ü‡¶ø ‡¶∏‡¶Æ‡ßç‡¶¨‡¶®‡ßç‡¶ß‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®‡¶ü‡¶ø ‡¶ü‡¶æ‡¶á‡¶™ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§";

    var voiceButton = document.createElement("button");
    voiceButton.type = "button";
    voiceButton.className = "btn mt-4";
    voiceButton.id = "voiceBtn" + (i + 1);
    voiceButton.innerHTML = '<img src="https://www.iconfinder.com/icons/7123011/download/png/512" height="40" width="40" class="imageB">';

    voiceButton.addEventListener("click", function(event) {
        handleClick(event);
        });

    questionInputCol.appendChild(questionLabel);
    questionInputCol.appendChild(questionInput);

    questionRow.appendChild(questionInputCol);
    questionRow.appendChild(voiceButton);

    var answerCountLabel = document.createElement("label");
    answerCountLabel.textContent = "‡¶â‡¶§‡ßç‡¶§‡¶∞‡ßá‡¶∞ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ:";

    var answerCountInput = document.createElement("input");
    answerCountInput.type = "range";
    answerCountInput.name = "answerCount" + (i + 1);
    answerCountInput.min = "1";
    answerCountInput.max = "5";
    answerCountInput.value = "1";
    answerCountInput.title = "‡¶è‡¶ï‡¶á ‡¶™‡ßç‡¶∞‡¶∏‡¶ô‡ßç‡¶ó‡ßá ‡¶ú‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶∏‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®‡ßá‡¶∞ ‡¶è‡¶ï‡¶æ‡¶ß‡¶ø‡¶ï ‡¶∏‡¶†‡¶ø‡¶ï ‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶•‡¶æ‡¶ï‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§ ‡¶â‡¶™‡¶∞‡ßá ‡¶≤‡¶ø‡¶ñ‡¶ø‡¶§ ‡¶™‡ßç‡¶∞‡¶∏‡¶ô‡ßç‡¶ó‡ßá‡¶∞ ‡¶∏‡¶Æ‡ßç‡¶¨‡¶®‡ßç‡¶ß‡¶ø‡¶§ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®‡ßá‡¶∞ ‡¶∏‡¶Æ‡ßç‡¶≠‡¶æ‡¶¨‡ßç‡¶Ø ‡¶ú‡¶¨‡¶æ‡¶¨‡ßá‡¶∞ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®‡•§";
    answerCountInput.className = "answer-count-slider";
    answerCountInput.setAttribute("data-question-id", i + 1);
    answerCountInput.oninput = function () {
      var questionId = this.getAttribute("data-question-id");
      generateAnswerFields(questionId, this.value);
      updateAnswerCountDisplay(questionId, this.value);
    };

    var answerCountDisplay = document.createElement("span");
    answerCountDisplay.id = "answerCountDisplay" + (i + 1);
    answerCountDisplay.textContent = "1";

    var answerContainer = document.createElement("div");
    answerContainer.id = "answerContainer" + (i + 1);
    answerContainer.className = "answer-container";

    questionContainer.appendChild(questionRow);
    questionContainer.appendChild(answerCountLabel);
    questionContainer.appendChild(answerCountInput);
    questionContainer.appendChild(answerCountDisplay);
    questionContainer.appendChild(answerContainer);

    fieldsContainer.appendChild(questionContainer);

    generateAnswerFields(i + 1, 1);
  }

  document.getElementById("numberDisplay").textContent = value;
}

function generateAnswerFields(questionId, answerCount) {
    var answerContainer = document.getElementById("answerContainer" + questionId);
    answerContainer.innerHTML = "";
  for (var i = 0; i < answerCount; i++) {
    var answerRow = document.createElement("div");
    answerRow.className = "row";

    var answerCol = document.createElement("div");
    answerCol.className = "col";

    var answerLabel = document.createElement("label");
    answerLabel.textContent = "‡¶â‡¶§‡ßç‡¶§‡¶∞ " + (i + 1);

    var answerInput = document.createElement("input");
    answerInput.type = "text";
    answerInput.name = "answer" + questionId + "_" + (i + 1);
    answerInput.id = "answer" + questionId + "_" + (i + 1);
    answerInput.placeholder = "‡¶∞‡¶¨‡ßÄ‡¶®‡ßç‡¶¶‡ßç‡¶∞‡¶®‡¶æ‡¶• ‡¶†‡¶æ‡¶ï‡ßÅ‡¶∞";
    answerInput.className = "dynamic-input-answer";
    answerInput.title = "‡¶â‡¶™‡¶∞‡ßá ‡¶≤‡¶ø‡¶ñ‡¶ø‡¶§ ‡¶™‡ßç‡¶∞‡¶∏‡¶ô‡ßç‡¶ó‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®‡¶ü‡¶ø‡¶∞ ‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶¶‡¶ø‡¶®";

    var voiceButton = document.createElement("button");
    voiceButton.type = "button";
    voiceButton.className = "btn mt-4";
    voiceButton.id = "voiceBtn" + questionId + "_" + (i + 1);
    voiceButton.innerHTML = '<img src="https://www.iconfinder.com/icons/7123011/download/png/512" height="40" width="40" class="imageB">';

    voiceButton.addEventListener("click", function(event) {
            handleClick(event);
        });

    answerCol.appendChild(answerLabel);
    answerCol.appendChild(answerInput);
    answerRow.appendChild(answerCol);
    answerRow.appendChild(voiceButton);
    answerContainer.appendChild(answerRow);
  }
}

function updateAnswerCountDisplay(questionId, answerCount) {
  var answerCountDisplay = document.getElementById("answerCountDisplay" + questionId);
  answerCountDisplay.textContent = answerCount;
}
    </script>
    <script>
        const audioContext = new window.AudioContext() || window.webkitAudioContext();
        let mediaStreamSource = null;
        const analyser = audioContext.createAnalyser();

        analyser.fftSize = 256;
        const bufferLength = analyser.frequencyBinCount;
        const dataArray = new Uint8Array(bufferLength);

        navigator.mediaDevices.getUserMedia({ audio: true })
            .then(function (stream) {
                mediaStreamSource = audioContext.createMediaStreamSource(stream);
                mediaStreamSource.connect(analyser);
            })
            .catch(function (err) {
                console.error('Error accessing microphone:', err);
            });

        const recognition = new webkitSpeechRecognition() || new SpeechRecognition();
        recognition.continuous = false;
        recognition.interimResults = true;
        recognition.lang = 'bn-IN';

        let listening = false;
        function stopMicrophone() {
            if (listening) {
                recognition.stop();
                listening = false;
                voiceBtn.classList.remove('listening');
                voiceBtn.removeAttribute('disabled');
                voiceBtn.title = "Click to start listening";
            }
        }

        let output = null;
        var voiceBtn = null;
        function handleClick(event) {
            voiceBtn = event.currentTarget;
            if (voiceBtn.id.length == 11) {
                output = document.getElementById(voiceBtn.id.replace("voiceBtn", "answer"));
            } else if (voiceBtn.id.length == 9) {
                output = document.getElementById(voiceBtn.id.replace("voiceBtn", "question"));
            } else output = document.getElementById("contextInp");
            
            if (!listening) {
                voiceBtn.classList.add('listening');
                voiceBtn.setAttribute('disabled', 'disabled');
                voiceBtn.title = "Click to stop listening";
                recognition.start();
                listening = true;
            } else {
                stopMicrophone();
            }
        }

        recognition.onresult = (event) => {
            const result = event.results[0][0].transcript;
            output.value = result;
        };
        recognition.onend = () => {
            if (listening) {
                voiceBtn.classList.remove('listening');
                voiceBtn.removeAttribute('disabled');
                voiceBtn.title = "Click to start listening";
                voiceBtn.title = "Click to start listening";
                listening = false;
            }
        };
    </script>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>
